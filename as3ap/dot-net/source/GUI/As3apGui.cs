//
// AS3AP -	An ANSI SQL Standard Scalable and Portable Benchmark
//			for Relational Database Systems.
// Copyright (C) 2003-2006  Carlos Guzman Alvarez
//
// Distributable under LGPL license.
// You may obtain a copy of the License at http://www.gnu.org/copyleft/lesser.html
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 2.1 of the License, or (at your option) any later version.
// 
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Lesser General Public License for more details.
//

using System;
using System.Collections;
using System.IO;
using System.Text;
using System.Drawing;
using System.Windows.Forms;
using System.Threading;
using System.Configuration;

// This file was autogenerated by a tool.
namespace DatabaseBenchmark
{		
	public class As3apGui : System.Windows.Forms.Form
    {
        #region · Delegates ·

        public delegate void ShowTestResultHandler(TestResultEventArgs e);
        public delegate void ShowProgressMessageHandler(string message);

        #endregion

		#region · Fields ·

		private Thread					runThread;
		private AS3AP					as3ap;
		private TestResultEventHandler	testResultHandler;
		private ProgressMessageEventHandler	progressMessageHandler;

		private System.Windows.Forms.TextBox txtUserNumber;
		private System.Windows.Forms.Label lblRunSequence;
		private System.Windows.Forms.Button cmdGetDataPath;
		private System.Windows.Forms.Label lblChar;
		private System.Windows.Forms.Label lblHashIndex;
		private System.Windows.Forms.Button cmdRun;
		private System.Windows.Forms.TextBox txtClusterIndex;
		private System.Windows.Forms.Label lblConnectionStringName;
		private System.Windows.Forms.TabPage tabProvider;		
		private System.Windows.Forms.Label lblBtreeIndex;
		private System.Windows.Forms.Button cmdSave;		
		private System.Windows.Forms.Label lblUSerNumber;
		private System.Windows.Forms.TextBox txtInteger;
		private System.Windows.Forms.Label label2;
		private System.Windows.Forms.TabPage tabGeneral;
		private System.Windows.Forms.TextBox txtConnectionStringName;
		private System.Windows.Forms.TextBox txtDecimal;
		private System.Windows.Forms.TextBox txtRunSequence;
		private System.Windows.Forms.TextBox txtVarchar;
		private System.Windows.Forms.TabControl tabBenchmark;
		private System.Windows.Forms.CheckBox chkHashIndexes;
		private System.Windows.Forms.CheckBox chkClusterIndexes;		
		private System.Windows.Forms.CheckBox chkCreateDB;
		private System.Windows.Forms.Label lblInteger;
		private System.Windows.Forms.CheckBox chkCreateIndexes;
		private System.Windows.Forms.TextBox txtDataFilesPath;
		private System.Windows.Forms.TextBox txtDouble;
		private System.Windows.Forms.Button cmdLoad;
		private System.Windows.Forms.Label lblClusterIndex;
		private System.Windows.Forms.TabPage tabConfig;
		private System.Windows.Forms.Label lblFloat;
		private System.Windows.Forms.TextBox txtFloat;
		private System.Windows.Forms.TextBox txtHashIndex;
		private System.Windows.Forms.TabPage tabRDBMS;
		private System.Windows.Forms.TabPage tabRun;
		private System.Windows.Forms.TextBox txtChar;
		private System.Windows.Forms.GroupBox grbDataTypes;
		private System.Windows.Forms.Label lblDouble;
		private System.Windows.Forms.TextBox txtBTreeIndex;
		private System.Windows.Forms.Label lblVarchar;
		private System.Windows.Forms.Label lblDecimal;
		private System.Windows.Forms.ColumnHeader colName;
		private System.Windows.Forms.ColumnHeader colResult;
		private System.Windows.Forms.ColumnHeader colTime;
		private System.Windows.Forms.ColumnHeader colFailed;
		private System.Windows.Forms.ListView lstTestResults;
		private System.Windows.Forms.Label lblProgressMessage;
		private System.Windows.Forms.Button cmdStop;
		private System.Windows.Forms.CheckBox chkEnableLog;
        private System.Windows.Forms.CheckBox chkEnableErrorLog;
        private TextBox txtCreateDatabase;
        private Label lblCreateDatabase;
        private System.ComponentModel.BackgroundWorker benchmarkBackgroundWorker;
        private TextBox txtDropDatabase;
        private Label lblDropDatabase;
        private BindingSource bindingSource;
        private System.ComponentModel.IContainer components;
        private System.Windows.Forms.TabControl tabControl;
	
		#endregion

		#region · Constructors ·

		public As3apGui()
		{
			// Initialize component
			this.InitializeComponent();
					
			// Load Default config file.
			this.LoadDefaultConfig();

            Application.Idle += new EventHandler(this.UpdateState);
        }

		#endregion

		#region · Designer Methods ·
		
		private void InitializeComponent() 
		{
            this.components = new System.ComponentModel.Container();
            this.tabControl = new System.Windows.Forms.TabControl();
            this.tabGeneral = new System.Windows.Forms.TabPage();
            this.chkEnableErrorLog = new System.Windows.Forms.CheckBox();
            this.chkEnableLog = new System.Windows.Forms.CheckBox();
            this.cmdGetDataPath = new System.Windows.Forms.Button();
            this.txtDataFilesPath = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.chkCreateIndexes = new System.Windows.Forms.CheckBox();
            this.txtRunSequence = new System.Windows.Forms.TextBox();
            this.lblRunSequence = new System.Windows.Forms.Label();
            this.chkCreateDB = new System.Windows.Forms.CheckBox();
            this.txtUserNumber = new System.Windows.Forms.TextBox();
            this.lblUSerNumber = new System.Windows.Forms.Label();
            this.tabRDBMS = new System.Windows.Forms.TabPage();
            this.txtDropDatabase = new System.Windows.Forms.TextBox();
            this.lblDropDatabase = new System.Windows.Forms.Label();
            this.txtCreateDatabase = new System.Windows.Forms.TextBox();
            this.lblCreateDatabase = new System.Windows.Forms.Label();
            this.grbDataTypes = new System.Windows.Forms.GroupBox();
            this.txtVarchar = new System.Windows.Forms.TextBox();
            this.lblVarchar = new System.Windows.Forms.Label();
            this.txtChar = new System.Windows.Forms.TextBox();
            this.lblChar = new System.Windows.Forms.Label();
            this.txtDecimal = new System.Windows.Forms.TextBox();
            this.lblDecimal = new System.Windows.Forms.Label();
            this.txtDouble = new System.Windows.Forms.TextBox();
            this.lblDouble = new System.Windows.Forms.Label();
            this.txtFloat = new System.Windows.Forms.TextBox();
            this.lblFloat = new System.Windows.Forms.Label();
            this.txtInteger = new System.Windows.Forms.TextBox();
            this.lblInteger = new System.Windows.Forms.Label();
            this.chkHashIndexes = new System.Windows.Forms.CheckBox();
            this.chkClusterIndexes = new System.Windows.Forms.CheckBox();
            this.txtHashIndex = new System.Windows.Forms.TextBox();
            this.lblHashIndex = new System.Windows.Forms.Label();
            this.txtClusterIndex = new System.Windows.Forms.TextBox();
            this.lblClusterIndex = new System.Windows.Forms.Label();
            this.txtBTreeIndex = new System.Windows.Forms.TextBox();
            this.lblBtreeIndex = new System.Windows.Forms.Label();
            this.tabProvider = new System.Windows.Forms.TabPage();
            this.lblConnectionStringName = new System.Windows.Forms.Label();
            this.txtConnectionStringName = new System.Windows.Forms.TextBox();
            this.tabRun = new System.Windows.Forms.TabPage();
            this.cmdStop = new System.Windows.Forms.Button();
            this.lblProgressMessage = new System.Windows.Forms.Label();
            this.lstTestResults = new System.Windows.Forms.ListView();
            this.colName = new System.Windows.Forms.ColumnHeader();
            this.colResult = new System.Windows.Forms.ColumnHeader();
            this.colTime = new System.Windows.Forms.ColumnHeader();
            this.colFailed = new System.Windows.Forms.ColumnHeader();
            this.cmdRun = new System.Windows.Forms.Button();
            this.tabConfig = new System.Windows.Forms.TabPage();
            this.cmdSave = new System.Windows.Forms.Button();
            this.cmdLoad = new System.Windows.Forms.Button();
            this.tabBenchmark = new System.Windows.Forms.TabControl();
            this.benchmarkBackgroundWorker = new System.ComponentModel.BackgroundWorker();
            this.bindingSource = new System.Windows.Forms.BindingSource(this.components);
            this.tabControl.SuspendLayout();
            this.tabGeneral.SuspendLayout();
            this.tabRDBMS.SuspendLayout();
            this.grbDataTypes.SuspendLayout();
            this.tabProvider.SuspendLayout();
            this.tabRun.SuspendLayout();
            this.tabConfig.SuspendLayout();
            this.tabBenchmark.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.bindingSource)).BeginInit();
            this.SuspendLayout();
            // 
            // tabControl
            // 
            this.tabControl.Controls.Add(this.tabGeneral);
            this.tabControl.Controls.Add(this.tabRDBMS);
            this.tabControl.Controls.Add(this.tabProvider);
            this.tabControl.Location = new System.Drawing.Point(8, 40);
            this.tabControl.Name = "tabControl";
            this.tabControl.SelectedIndex = 0;
            this.tabControl.Size = new System.Drawing.Size(456, 248);
            this.tabControl.TabIndex = 2;
            // 
            // tabGeneral
            // 
            this.tabGeneral.Controls.Add(this.chkEnableErrorLog);
            this.tabGeneral.Controls.Add(this.chkEnableLog);
            this.tabGeneral.Controls.Add(this.cmdGetDataPath);
            this.tabGeneral.Controls.Add(this.txtDataFilesPath);
            this.tabGeneral.Controls.Add(this.label2);
            this.tabGeneral.Controls.Add(this.chkCreateIndexes);
            this.tabGeneral.Controls.Add(this.txtRunSequence);
            this.tabGeneral.Controls.Add(this.lblRunSequence);
            this.tabGeneral.Controls.Add(this.chkCreateDB);
            this.tabGeneral.Controls.Add(this.txtUserNumber);
            this.tabGeneral.Controls.Add(this.lblUSerNumber);
            this.tabGeneral.Location = new System.Drawing.Point(4, 22);
            this.tabGeneral.Name = "tabGeneral";
            this.tabGeneral.Size = new System.Drawing.Size(448, 222);
            this.tabGeneral.TabIndex = 0;
            this.tabGeneral.Text = "General";
            // 
            // chkEnableErrorLog
            // 
            this.chkEnableErrorLog.DataBindings.Add(new System.Windows.Forms.Binding("Checked", this.bindingSource, "EnableErrorLogging", true));
            this.chkEnableErrorLog.Location = new System.Drawing.Point(8, 65);
            this.chkEnableErrorLog.Name = "chkEnableErrorLog";
            this.chkEnableErrorLog.Size = new System.Drawing.Size(136, 16);
            this.chkEnableErrorLog.TabIndex = 10;
            this.chkEnableErrorLog.Text = "Enable error logging";
            // 
            // chkEnableLog
            // 
            this.chkEnableLog.DataBindings.Add(new System.Windows.Forms.Binding("Checked", this.bindingSource, "EnableLogging", true));
            this.chkEnableLog.Location = new System.Drawing.Point(8, 46);
            this.chkEnableLog.Name = "chkEnableLog";
            this.chkEnableLog.Size = new System.Drawing.Size(104, 16);
            this.chkEnableLog.TabIndex = 2;
            this.chkEnableLog.Text = "Enable logging";
            // 
            // cmdGetDataPath
            // 
            this.cmdGetDataPath.Location = new System.Drawing.Point(280, 96);
            this.cmdGetDataPath.Name = "cmdGetDataPath";
            this.cmdGetDataPath.Size = new System.Drawing.Size(24, 24);
            this.cmdGetDataPath.TabIndex = 8;
            this.cmdGetDataPath.Text = "...";
            // 
            // txtDataFilesPath
            // 
            this.txtDataFilesPath.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "DataPath", true));
            this.txtDataFilesPath.Location = new System.Drawing.Point(168, 120);
            this.txtDataFilesPath.Multiline = true;
            this.txtDataFilesPath.Name = "txtDataFilesPath";
            this.txtDataFilesPath.Size = new System.Drawing.Size(264, 56);
            this.txtDataFilesPath.TabIndex = 9;
            // 
            // label2
            // 
            this.label2.Location = new System.Drawing.Point(168, 104);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(100, 16);
            this.label2.TabIndex = 7;
            this.label2.Text = "Data files path";
            // 
            // chkCreateIndexes
            // 
            this.chkCreateIndexes.DataBindings.Add(new System.Windows.Forms.Binding("Checked", this.bindingSource, "UseIndexes", true));
            this.chkCreateIndexes.Location = new System.Drawing.Point(8, 27);
            this.chkCreateIndexes.Name = "chkCreateIndexes";
            this.chkCreateIndexes.Size = new System.Drawing.Size(104, 16);
            this.chkCreateIndexes.TabIndex = 1;
            this.chkCreateIndexes.Text = "Create indexes";
            // 
            // txtRunSequence
            // 
            this.txtRunSequence.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "RunSequence", true));
            this.txtRunSequence.Location = new System.Drawing.Point(168, 32);
            this.txtRunSequence.Multiline = true;
            this.txtRunSequence.Name = "txtRunSequence";
            this.txtRunSequence.Size = new System.Drawing.Size(264, 56);
            this.txtRunSequence.TabIndex = 6;
            // 
            // lblRunSequence
            // 
            this.lblRunSequence.Location = new System.Drawing.Point(168, 16);
            this.lblRunSequence.Name = "lblRunSequence";
            this.lblRunSequence.Size = new System.Drawing.Size(100, 16);
            this.lblRunSequence.TabIndex = 5;
            this.lblRunSequence.Text = "Run sequence";
            // 
            // chkCreateDB
            // 
            this.chkCreateDB.DataBindings.Add(new System.Windows.Forms.Binding("Checked", this.bindingSource, "RunCreate", true));
            this.chkCreateDB.Location = new System.Drawing.Point(8, 8);
            this.chkCreateDB.Name = "chkCreateDB";
            this.chkCreateDB.Size = new System.Drawing.Size(144, 16);
            this.chkCreateDB.TabIndex = 0;
            this.chkCreateDB.Text = "Create database tables";
            // 
            // txtUserNumber
            // 
            this.txtUserNumber.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "UserNumber", true));
            this.txtUserNumber.Location = new System.Drawing.Point(8, 120);
            this.txtUserNumber.Name = "txtUserNumber";
            this.txtUserNumber.Size = new System.Drawing.Size(100, 20);
            this.txtUserNumber.TabIndex = 4;
            // 
            // lblUSerNumber
            // 
            this.lblUSerNumber.Location = new System.Drawing.Point(8, 104);
            this.lblUSerNumber.Name = "lblUSerNumber";
            this.lblUSerNumber.Size = new System.Drawing.Size(80, 16);
            this.lblUSerNumber.TabIndex = 3;
            this.lblUSerNumber.Text = "User number";
            // 
            // tabRDBMS
            // 
            this.tabRDBMS.Controls.Add(this.txtDropDatabase);
            this.tabRDBMS.Controls.Add(this.lblDropDatabase);
            this.tabRDBMS.Controls.Add(this.txtCreateDatabase);
            this.tabRDBMS.Controls.Add(this.lblCreateDatabase);
            this.tabRDBMS.Controls.Add(this.grbDataTypes);
            this.tabRDBMS.Controls.Add(this.chkHashIndexes);
            this.tabRDBMS.Controls.Add(this.chkClusterIndexes);
            this.tabRDBMS.Controls.Add(this.txtHashIndex);
            this.tabRDBMS.Controls.Add(this.lblHashIndex);
            this.tabRDBMS.Controls.Add(this.txtClusterIndex);
            this.tabRDBMS.Controls.Add(this.lblClusterIndex);
            this.tabRDBMS.Controls.Add(this.txtBTreeIndex);
            this.tabRDBMS.Controls.Add(this.lblBtreeIndex);
            this.tabRDBMS.Location = new System.Drawing.Point(4, 22);
            this.tabRDBMS.Name = "tabRDBMS";
            this.tabRDBMS.Size = new System.Drawing.Size(448, 222);
            this.tabRDBMS.TabIndex = 2;
            this.tabRDBMS.Text = "RDBMS";
            // 
            // txtDropDatabase
            // 
            this.txtDropDatabase.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "DropDatabaseStmt", true));
            this.txtDropDatabase.Location = new System.Drawing.Point(102, 29);
            this.txtDropDatabase.Name = "txtDropDatabase";
            this.txtDropDatabase.Size = new System.Drawing.Size(338, 20);
            this.txtDropDatabase.TabIndex = 3;
            // 
            // lblDropDatabase
            // 
            this.lblDropDatabase.Location = new System.Drawing.Point(3, 32);
            this.lblDropDatabase.Name = "lblDropDatabase";
            this.lblDropDatabase.Size = new System.Drawing.Size(93, 16);
            this.lblDropDatabase.TabIndex = 2;
            this.lblDropDatabase.Text = "Drop Database";
            // 
            // txtCreateDatabase
            // 
            this.txtCreateDatabase.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "CreateDatabaseStmt", true));
            this.txtCreateDatabase.Location = new System.Drawing.Point(102, 3);
            this.txtCreateDatabase.Name = "txtCreateDatabase";
            this.txtCreateDatabase.Size = new System.Drawing.Size(338, 20);
            this.txtCreateDatabase.TabIndex = 1;
            // 
            // lblCreateDatabase
            // 
            this.lblCreateDatabase.Location = new System.Drawing.Point(3, 6);
            this.lblCreateDatabase.Name = "lblCreateDatabase";
            this.lblCreateDatabase.Size = new System.Drawing.Size(93, 16);
            this.lblCreateDatabase.TabIndex = 0;
            this.lblCreateDatabase.Text = "Create Database";
            // 
            // grbDataTypes
            // 
            this.grbDataTypes.Controls.Add(this.txtVarchar);
            this.grbDataTypes.Controls.Add(this.lblVarchar);
            this.grbDataTypes.Controls.Add(this.txtChar);
            this.grbDataTypes.Controls.Add(this.lblChar);
            this.grbDataTypes.Controls.Add(this.txtDecimal);
            this.grbDataTypes.Controls.Add(this.lblDecimal);
            this.grbDataTypes.Controls.Add(this.txtDouble);
            this.grbDataTypes.Controls.Add(this.lblDouble);
            this.grbDataTypes.Controls.Add(this.txtFloat);
            this.grbDataTypes.Controls.Add(this.lblFloat);
            this.grbDataTypes.Controls.Add(this.txtInteger);
            this.grbDataTypes.Controls.Add(this.lblInteger);
            this.grbDataTypes.Location = new System.Drawing.Point(8, 124);
            this.grbDataTypes.Name = "grbDataTypes";
            this.grbDataTypes.Size = new System.Drawing.Size(344, 91);
            this.grbDataTypes.TabIndex = 10;
            this.grbDataTypes.TabStop = false;
            this.grbDataTypes.Text = "Data Type names";
            // 
            // txtVarchar
            // 
            this.txtVarchar.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "VarcharTypeName", true));
            this.txtVarchar.Location = new System.Drawing.Point(222, 63);
            this.txtVarchar.Name = "txtVarchar";
            this.txtVarchar.Size = new System.Drawing.Size(112, 20);
            this.txtVarchar.TabIndex = 11;
            // 
            // lblVarchar
            // 
            this.lblVarchar.Location = new System.Drawing.Point(175, 65);
            this.lblVarchar.Name = "lblVarchar";
            this.lblVarchar.Size = new System.Drawing.Size(49, 16);
            this.lblVarchar.TabIndex = 10;
            this.lblVarchar.Text = "Varchar";
            // 
            // txtChar
            // 
            this.txtChar.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "CharTypeName", true));
            this.txtChar.Location = new System.Drawing.Point(222, 39);
            this.txtChar.Name = "txtChar";
            this.txtChar.Size = new System.Drawing.Size(112, 20);
            this.txtChar.TabIndex = 9;
            // 
            // lblChar
            // 
            this.lblChar.Location = new System.Drawing.Point(175, 41);
            this.lblChar.Name = "lblChar";
            this.lblChar.Size = new System.Drawing.Size(49, 16);
            this.lblChar.TabIndex = 8;
            this.lblChar.Text = "Char";
            // 
            // txtDecimal
            // 
            this.txtDecimal.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "DecimalTypeName", true));
            this.txtDecimal.Location = new System.Drawing.Point(222, 15);
            this.txtDecimal.Name = "txtDecimal";
            this.txtDecimal.Size = new System.Drawing.Size(112, 20);
            this.txtDecimal.TabIndex = 7;
            // 
            // lblDecimal
            // 
            this.lblDecimal.Location = new System.Drawing.Point(175, 17);
            this.lblDecimal.Name = "lblDecimal";
            this.lblDecimal.Size = new System.Drawing.Size(49, 16);
            this.lblDecimal.TabIndex = 6;
            this.lblDecimal.Text = "Decimal";
            // 
            // txtDouble
            // 
            this.txtDouble.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "DoubleTypeName", true));
            this.txtDouble.Location = new System.Drawing.Point(57, 63);
            this.txtDouble.Name = "txtDouble";
            this.txtDouble.Size = new System.Drawing.Size(112, 20);
            this.txtDouble.TabIndex = 5;
            // 
            // lblDouble
            // 
            this.lblDouble.Location = new System.Drawing.Point(8, 65);
            this.lblDouble.Name = "lblDouble";
            this.lblDouble.Size = new System.Drawing.Size(59, 16);
            this.lblDouble.TabIndex = 4;
            this.lblDouble.Text = "Double";
            // 
            // txtFloat
            // 
            this.txtFloat.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "FloatTypeName", true));
            this.txtFloat.Location = new System.Drawing.Point(57, 39);
            this.txtFloat.Name = "txtFloat";
            this.txtFloat.Size = new System.Drawing.Size(112, 20);
            this.txtFloat.TabIndex = 3;
            // 
            // lblFloat
            // 
            this.lblFloat.Location = new System.Drawing.Point(8, 41);
            this.lblFloat.Name = "lblFloat";
            this.lblFloat.Size = new System.Drawing.Size(59, 16);
            this.lblFloat.TabIndex = 2;
            this.lblFloat.Text = "Float";
            // 
            // txtInteger
            // 
            this.txtInteger.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "IntegerTypeName", true));
            this.txtInteger.Location = new System.Drawing.Point(57, 15);
            this.txtInteger.Name = "txtInteger";
            this.txtInteger.Size = new System.Drawing.Size(112, 20);
            this.txtInteger.TabIndex = 1;
            // 
            // lblInteger
            // 
            this.lblInteger.Location = new System.Drawing.Point(8, 17);
            this.lblInteger.Name = "lblInteger";
            this.lblInteger.Size = new System.Drawing.Size(59, 16);
            this.lblInteger.TabIndex = 0;
            this.lblInteger.Text = "Integer";
            // 
            // chkHashIndexes
            // 
            this.chkHashIndexes.DataBindings.Add(new System.Windows.Forms.Binding("Checked", this.bindingSource, "SupportsHashIndexes", true));
            this.chkHashIndexes.Location = new System.Drawing.Point(358, 165);
            this.chkHashIndexes.Name = "chkHashIndexes";
            this.chkHashIndexes.Size = new System.Drawing.Size(82, 42);
            this.chkHashIndexes.TabIndex = 12;
            this.chkHashIndexes.Text = "Hash indexes";
            // 
            // chkClusterIndexes
            // 
            this.chkClusterIndexes.DataBindings.Add(new System.Windows.Forms.Binding("Checked", this.bindingSource, "SupportsClusteredIndexes", true));
            this.chkClusterIndexes.Location = new System.Drawing.Point(358, 129);
            this.chkClusterIndexes.Name = "chkClusterIndexes";
            this.chkClusterIndexes.Size = new System.Drawing.Size(82, 43);
            this.chkClusterIndexes.TabIndex = 11;
            this.chkClusterIndexes.Text = "Clustered indexes";
            // 
            // txtHashIndex
            // 
            this.txtHashIndex.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "HashIndexStmt", true));
            this.txtHashIndex.Location = new System.Drawing.Point(80, 103);
            this.txtHashIndex.Name = "txtHashIndex";
            this.txtHashIndex.Size = new System.Drawing.Size(360, 20);
            this.txtHashIndex.TabIndex = 9;
            // 
            // lblHashIndex
            // 
            this.lblHashIndex.Location = new System.Drawing.Point(3, 104);
            this.lblHashIndex.Name = "lblHashIndex";
            this.lblHashIndex.Size = new System.Drawing.Size(77, 16);
            this.lblHashIndex.TabIndex = 8;
            this.lblHashIndex.Text = "Hash Index";
            // 
            // txtClusterIndex
            // 
            this.txtClusterIndex.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "ClusteredIndexStmt", true));
            this.txtClusterIndex.Location = new System.Drawing.Point(80, 79);
            this.txtClusterIndex.Name = "txtClusterIndex";
            this.txtClusterIndex.Size = new System.Drawing.Size(360, 20);
            this.txtClusterIndex.TabIndex = 7;
            // 
            // lblClusterIndex
            // 
            this.lblClusterIndex.Location = new System.Drawing.Point(3, 80);
            this.lblClusterIndex.Name = "lblClusterIndex";
            this.lblClusterIndex.Size = new System.Drawing.Size(77, 16);
            this.lblClusterIndex.TabIndex = 6;
            this.lblClusterIndex.Text = "Cluster Index";
            // 
            // txtBTreeIndex
            // 
            this.txtBTreeIndex.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "BtreeIndexStmt", true));
            this.txtBTreeIndex.Location = new System.Drawing.Point(80, 55);
            this.txtBTreeIndex.Name = "txtBTreeIndex";
            this.txtBTreeIndex.Size = new System.Drawing.Size(360, 20);
            this.txtBTreeIndex.TabIndex = 5;
            // 
            // lblBtreeIndex
            // 
            this.lblBtreeIndex.Location = new System.Drawing.Point(3, 56);
            this.lblBtreeIndex.Name = "lblBtreeIndex";
            this.lblBtreeIndex.Size = new System.Drawing.Size(77, 16);
            this.lblBtreeIndex.TabIndex = 4;
            this.lblBtreeIndex.Text = "BTree Index";
            // 
            // tabProvider
            // 
            this.tabProvider.Controls.Add(this.lblConnectionStringName);
            this.tabProvider.Controls.Add(this.txtConnectionStringName);
            this.tabProvider.Location = new System.Drawing.Point(4, 22);
            this.tabProvider.Name = "tabProvider";
            this.tabProvider.Size = new System.Drawing.Size(448, 222);
            this.tabProvider.TabIndex = 1;
            this.tabProvider.Text = "ADO.NET Provider";
            // 
            // lblConnectionStringName
            // 
            this.lblConnectionStringName.Location = new System.Drawing.Point(121, 93);
            this.lblConnectionStringName.Name = "lblConnectionStringName";
            this.lblConnectionStringName.Size = new System.Drawing.Size(129, 16);
            this.lblConnectionStringName.TabIndex = 10;
            this.lblConnectionStringName.Text = "ConnectionString Name";
            // 
            // txtConnectionStringName
            // 
            this.txtConnectionStringName.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.bindingSource, "ConnectionStringName", true));
            this.txtConnectionStringName.Location = new System.Drawing.Point(121, 109);
            this.txtConnectionStringName.Multiline = true;
            this.txtConnectionStringName.Name = "txtConnectionStringName";
            this.txtConnectionStringName.Size = new System.Drawing.Size(206, 20);
            this.txtConnectionStringName.TabIndex = 11;
            // 
            // tabRun
            // 
            this.tabRun.Controls.Add(this.cmdStop);
            this.tabRun.Controls.Add(this.lblProgressMessage);
            this.tabRun.Controls.Add(this.lstTestResults);
            this.tabRun.Controls.Add(this.cmdRun);
            this.tabRun.Location = new System.Drawing.Point(4, 22);
            this.tabRun.Name = "tabRun";
            this.tabRun.Size = new System.Drawing.Size(472, 294);
            this.tabRun.TabIndex = 1;
            this.tabRun.Text = "Run benchmark";
            // 
            // cmdStop
            // 
            this.cmdStop.Enabled = false;
            this.cmdStop.Location = new System.Drawing.Point(88, 6);
            this.cmdStop.Name = "cmdStop";
            this.cmdStop.Size = new System.Drawing.Size(75, 24);
            this.cmdStop.TabIndex = 3;
            this.cmdStop.Text = "&Stop";
            this.cmdStop.Click += new System.EventHandler(this.cmdStop_Click);
            // 
            // lblProgressMessage
            // 
            this.lblProgressMessage.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.lblProgressMessage.Location = new System.Drawing.Point(8, 264);
            this.lblProgressMessage.Name = "lblProgressMessage";
            this.lblProgressMessage.Size = new System.Drawing.Size(456, 24);
            this.lblProgressMessage.TabIndex = 2;
            this.lblProgressMessage.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
            // 
            // lstTestResults
            // 
            this.lstTestResults.Columns.AddRange(new System.Windows.Forms.ColumnHeader[] {
            this.colName,
            this.colResult,
            this.colTime,
            this.colFailed});
            this.lstTestResults.FullRowSelect = true;
            this.lstTestResults.GridLines = true;
            this.lstTestResults.Location = new System.Drawing.Point(8, 33);
            this.lstTestResults.MultiSelect = false;
            this.lstTestResults.Name = "lstTestResults";
            this.lstTestResults.Size = new System.Drawing.Size(456, 224);
            this.lstTestResults.TabIndex = 1;
            this.lstTestResults.UseCompatibleStateImageBehavior = false;
            this.lstTestResults.View = System.Windows.Forms.View.Details;
            // 
            // colName
            // 
            this.colName.Text = "Name";
            this.colName.Width = 150;
            // 
            // colResult
            // 
            this.colResult.Text = "Result";
            this.colResult.Width = 100;
            // 
            // colTime
            // 
            this.colTime.Text = "Time";
            this.colTime.Width = 100;
            // 
            // colFailed
            // 
            this.colFailed.Text = "Failed";
            this.colFailed.Width = 75;
            // 
            // cmdRun
            // 
            this.cmdRun.Location = new System.Drawing.Point(8, 6);
            this.cmdRun.Name = "cmdRun";
            this.cmdRun.Size = new System.Drawing.Size(75, 24);
            this.cmdRun.TabIndex = 0;
            this.cmdRun.Text = "&Run";
            this.cmdRun.Click += new System.EventHandler(this.cmdRun_Click);
            // 
            // tabConfig
            // 
            this.tabConfig.Controls.Add(this.tabControl);
            this.tabConfig.Controls.Add(this.cmdSave);
            this.tabConfig.Controls.Add(this.cmdLoad);
            this.tabConfig.Location = new System.Drawing.Point(4, 22);
            this.tabConfig.Name = "tabConfig";
            this.tabConfig.Size = new System.Drawing.Size(472, 294);
            this.tabConfig.TabIndex = 0;
            this.tabConfig.Text = "Configuration";
            // 
            // cmdSave
            // 
            this.cmdSave.Location = new System.Drawing.Point(64, 8);
            this.cmdSave.Name = "cmdSave";
            this.cmdSave.Size = new System.Drawing.Size(56, 23);
            this.cmdSave.TabIndex = 1;
            this.cmdSave.Text = "Save";
            this.cmdSave.Click += new System.EventHandler(this.cmdSave_Click);
            // 
            // cmdLoad
            // 
            this.cmdLoad.Location = new System.Drawing.Point(8, 8);
            this.cmdLoad.Name = "cmdLoad";
            this.cmdLoad.Size = new System.Drawing.Size(56, 23);
            this.cmdLoad.TabIndex = 0;
            this.cmdLoad.Text = "Load";
            this.cmdLoad.Click += new System.EventHandler(this.cmdLoad_Click);
            // 
            // tabBenchmark
            // 
            this.tabBenchmark.Controls.Add(this.tabConfig);
            this.tabBenchmark.Controls.Add(this.tabRun);
            this.tabBenchmark.Location = new System.Drawing.Point(8, 8);
            this.tabBenchmark.Name = "tabBenchmark";
            this.tabBenchmark.SelectedIndex = 0;
            this.tabBenchmark.Size = new System.Drawing.Size(480, 320);
            this.tabBenchmark.TabIndex = 0;
            // 
            // benchmarkBackgroundWorker
            // 
            this.benchmarkBackgroundWorker.WorkerReportsProgress = true;
            this.benchmarkBackgroundWorker.WorkerSupportsCancellation = true;
            this.benchmarkBackgroundWorker.DoWork += new System.ComponentModel.DoWorkEventHandler(this.benchmarkBackgroundWorker_DoWork);
            this.benchmarkBackgroundWorker.RunWorkerCompleted += new System.ComponentModel.RunWorkerCompletedEventHandler(this.benchmarkBackgroundWorker_RunWorkerCompleted);
            // 
            // bindingSource
            // 
            this.bindingSource.AllowNew = true;
            this.bindingSource.DataSource = typeof(DatabaseBenchmark.BenchMarkConfiguration);
            // 
            // As3apGui
            // 
            this.AutoScaleBaseSize = new System.Drawing.Size(5, 13);
            this.ClientSize = new System.Drawing.Size(496, 335);
            this.Controls.Add(this.tabBenchmark);
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
            this.MaximizeBox = false;
            this.Name = "As3apGui";
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
            this.Text = "AS3AP Benchmark";
            this.Closing += new System.ComponentModel.CancelEventHandler(this.As3apGui_Closing);
            this.Load += new System.EventHandler(this.As3apGui_Load);
            this.tabControl.ResumeLayout(false);
            this.tabGeneral.ResumeLayout(false);
            this.tabGeneral.PerformLayout();
            this.tabRDBMS.ResumeLayout(false);
            this.tabRDBMS.PerformLayout();
            this.grbDataTypes.ResumeLayout(false);
            this.grbDataTypes.PerformLayout();
            this.tabProvider.ResumeLayout(false);
            this.tabProvider.PerformLayout();
            this.tabRun.ResumeLayout(false);
            this.tabConfig.ResumeLayout(false);
            this.tabBenchmark.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.bindingSource)).EndInit();
            this.ResumeLayout(false);

        }

		#endregion

		#region · Event Handler Methods ·

        private void As3apGui_Load(object sender, EventArgs e)
        {
            this.bindingSource.Add(new BenchMarkConfiguration());
        }

		private void As3apGui_Closing(object sender, System.ComponentModel.CancelEventArgs e)
		{
			if (this.benchmarkBackgroundWorker.IsBusy)
			{
				this.benchmarkBackgroundWorker.CancelAsync();
			}
		}

		private void cmdLoad_Click(object sender, System.EventArgs e)
		{
			OpenFileDialog openDlg = new OpenFileDialog();

			openDlg.Filter = "Archivos Config (*.config)|*.config|"	+
				"All files (*.*)|*.*" ;
			
			openDlg.ShowDialog();
			
			this.Refresh();
	
			string fileName = openDlg.FileName;

			if (fileName != null && fileName.Length > 0)
			{
				try
				{
					FileInfo info = new FileInfo(fileName);

                    this.bindingSource.Clear();
					this.bindingSource.Add(BenchMarkConfiguration.Load(info.FullName));
				}
				catch (Exception ex)
				{
					MessageBox.Show(this, ex.Message, "Error loading config file");
				}
			}
		}

		private void cmdSave_Click(object sender, System.EventArgs e)
		{
			SaveFileDialog saveDlg = new SaveFileDialog();

			saveDlg.Filter = "Archivos Config (*.config)|*.config|"	+ "All files (*.*)|*.*" ;
			
			saveDlg.ShowDialog();
			
			this.Refresh();
            
			string fileName = saveDlg.FileName;

			if (fileName != null && fileName.Length > 0)
			{
				FileInfo info = new FileInfo(fileName);

                BenchMarkConfiguration configuration = (BenchMarkConfiguration)bindingSource.Current;

				configuration.Save(info.FullName);
			}
		}

		private void cmdRun_Click(object sender, System.EventArgs e)
		{
            this.benchmarkBackgroundWorker.RunWorkerAsync();
		}

		private void cmdStop_Click(object sender, System.EventArgs e)
		{
            this.benchmarkBackgroundWorker.CancelAsync();
		}

		private void OnTestResult(object Sender, TestResultEventArgs e)
		{
            this.lstTestResults.Invoke(new ShowTestResultHandler(this.ShowTestResult), new object[] { e });
        }

        private void OnProgressMessage(object Sender, ProgressMessageEventArgs e)
		{
            this.lblProgressMessage.Invoke(new ShowProgressMessageHandler(this.ShowProgressMessage), new object[] { e.Message });
		}

        #region · BackgroundWorker Event Handlers ·

        private void benchmarkBackgroundWorker_DoWork(object sender, System.ComponentModel.DoWorkEventArgs e)
        {
            // Clear ListView contents
            this.lstTestResults.Items.Clear();

            // Run the benchmark
            this.RunBenchMark();
        }

        private void benchmarkBackgroundWorker_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
        {
            this.ShowProgressMessage("Stopping benchmark");

            if (this.testResultHandler != null)
            {
                this.as3ap.TestResult -= testResultHandler;
            }
            if (this.progressMessageHandler != null)
            {
                this.as3ap.ProgressMessage -= progressMessageHandler;
            }

            if (this.as3ap != null)
            {
                this.as3ap.Dispose();
                this.as3ap = null;
            }

            this.ShowProgressMessage("Stopped");
        }

        #endregion

		#endregion

		#region · Private Methods ·

		private void LoadDefaultConfig()
		{
			string defaultConfig = ConfigurationSettings.AppSettings["DefaultConfigFile"];

			if (defaultConfig != null)
			{
				if (File.Exists(defaultConfig))
				{
					FileInfo info = new FileInfo(defaultConfig);

					try
					{
                        this.bindingSource.Clear();
                        this.bindingSource.Add(BenchMarkConfiguration.Load(info.FullName));

						// Set the second TAB as the active
						this.tabBenchmark.SelectedTab = this.tabRun;
					}
					catch (Exception ex)
					{
						MessageBox.Show(this, ex.Message, "Error loading config file");
					}
				}
			}
		}

		private void RunBenchMark()
		{
			try
			{
                BenchMarkConfiguration configuration = (BenchMarkConfiguration)bindingSource.DataSource;

                this.as3ap = new AS3AP(Path.GetDirectoryName(Application.ExecutablePath), configuration);

                // Test Result Event handler
                this.testResultHandler = new TestResultEventHandler(OnTestResult);
                this.as3ap.TestResult += this.testResultHandler;

                // Progress Message Event handler
                this.progressMessageHandler = new ProgressMessageEventHandler(OnProgressMessage);
                this.as3ap.ProgressMessage += this.progressMessageHandler;

                this.as3ap.Run();
			}
			catch (ThreadAbortException)
			{
			}
			catch (Exception ex)
			{
				StringBuilder e = new StringBuilder();

				e.AppendFormat("Message: \r\n {0} \r\n StackTrace: \r\n {1}", ex.Message, ex.StackTrace);
				MessageBox.Show(e.ToString(), "AS3AP Benchmark - Exception");
			}
			finally
			{
				if (this.testResultHandler != null)
				{
					this.as3ap.TestResult -= testResultHandler;
				}
				if (this.progressMessageHandler != null)
				{
					this.as3ap.ProgressMessage -= progressMessageHandler;
				}
                if (this.as3ap != null)
                {
                    this.as3ap.Dispose();
                    this.as3ap = null;
                }
            }
		}

    	private void UpdateState(object sender, EventArgs e)
		{
			// Update button state
			this.cmdRun.Enabled		= !this.benchmarkBackgroundWorker.IsBusy;
            this.cmdStop.Enabled    = this.benchmarkBackgroundWorker.IsBusy;
        }

		private void ShowProgressMessage(string message)
		{
			this.lblProgressMessage.Text = message;
			this.lblProgressMessage.Refresh();
		}

        private void ShowTestResult(TestResultEventArgs e)
        {
            ListViewItem item = new ListViewItem(e.TestName.Trim());

            item.SubItems.Add(e.TestResult.ToString());
            item.SubItems.Add(e.TestTime.ToString());
            item.SubItems.Add(e.TestFailed.ToString());

            this.lstTestResults.Items.Add(item);
            this.lstTestResults.EnsureVisible(lstTestResults.Items.Count - 1);
        }

		#endregion
    }
}
